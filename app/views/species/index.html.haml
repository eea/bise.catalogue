- content_for :pageheader do
    Species

- content_for :actions do
    = link_to  new_species_path, :class => "btn" do
        %i.icon-plus
        New Species
    = form_tag species_index_path, :method => 'get', :class => 'search-query pull-right' do       #
        = text_field_tag :query, params[:query], :class => "search-query", :placeholder => 'Search species...'    #

- content_for :js do
    = javascript_include_tag 'species'

.row
    .span3.menu-wrapper
        %ul.menu

            %li.item
                %a.title{ 'href' => '#', :class => 'active' }
                    Taxonomy Rank

                %ul.subitems
                    - if @species.respond_to?('facets')
                        - @species.facets['taxonomic_rank']['terms'].each do |facet|

                            - if !current_page?(params.merge(:taxonomic_rank => facet['term'], :page => 1))
                                %li.subitem
                                    = link_to params.merge(:taxonomic_rank => facet['term'], :page => 1) do
                                        = facet['term']
                                        %span= facet['count']

                            - else
                                %li.subitem.selected
                                    = facet['term']
                                    %span= link_to "Remove", params.except(:taxonomic_rank)

            %li.item
                %a.title{ 'href' => '#', :class => 'active' }
                    Genus

                %ul.subitems
                    - if @species.respond_to?('facets')
                        - @species.facets['genus']['terms'].each do |facet|

                            - if !current_page?(params.merge(:genus => facet['term'], :page => 1))
                                %li.subitem
                                    = link_to params.merge(:genus => facet['term'], :page => 1) do
                                        = facet['term']
                                        %span= facet['count']

                            - else
                                %li.subitem.selected
                                    = facet['term']
                                    %span= link_to "Remove", params.except(:genus)

            %li.item
                %a.title{ 'href' => '#', :class => 'active' }
                    Timeline

                %ul.subitems
                    - if @species.respond_to?('facets')
                        - @species.facets['timeline']['entries'].each do |facet|
                            - year = Time.at(facet['time']/1000).strftime("%Y")
                            - if !current_page?(params.merge(:published_on => year, :page => 1))
                                %li.subitem
                                    = link_to params.merge(:published_on => year, :page => 1) do
                                        = year
                                        %span= facet['count']

                            - else
                                %li.subitem.selected
                                    = year.to_s
                                    %span= link_to "Remove", params.except(:published_on)

    .span9
        - @species.results.each do |s|
            = render "cells/species", :species => s
        / %table.table.table-striped
        /     %thead
        /         %tr
        /             / %th Species code
        /             %th Binomial name
        /             / %th Valid name
        /             / %th Eunis primary name
        /             / %th Synonym for
        /             / %th Taxonomic rank
        /             / %th Taxonomy
        /             / %th Scientific name authorship
        /             %th Scientific name
        /             / %th Label
        /             / %th Genus
        /             / %th Species group
        /             / %th Name according to id
        /             / %th Ignore on match
        /             %th
        /             / %th
        /             / %th

        /     %tbody
        /         - @species.results.each do |s|
        /             = render "cells/species", :species => s
        /             / %tr

        /             /     / %td= species.species_code
        /             /     %td= species.binomial_name
        /             /     / %td= species.valid_name
        /             /     / %td= species.eunis_primary_name
        /             /     / %td= species.synonym_for
        /             /     / %td= species.taxonomic_rank
        /             /     / %td= species.taxonomy
        /             /     / %td= species.scientific_name_authorship
        /             /     %td= species.scientific_name
        /             /     / %td= species.label
        /             /     / %td= species.genus
        /             /     / %td= species.species_group
        /             /     / %td= species.name_according_to_ID
        /             /     / %td= species.ignore_on_match
        /             /     / %td= link_to 'Show', species
        /             /     / %td= link_to 'Edit', edit_species_path(species)
        /             /     / %td= link_to 'Destroy', species, method: :delete, data: { confirm: 'Are you sure?' }
        /             /     %td.actions
        /             /         = link_to species, :class => "btn btn-small" do
        /             /             %i.icon-eye-open

        = page_entries_info @species
        = will_paginate @species, :renderer => BootstrapPagination::Rails
