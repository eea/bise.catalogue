- content_for :pageheader do
    Species

- content_for :actions do
    = link_to  new_species_path, :class => "btn" do
        %i.icon-plus
        New Species
    = form_tag species_index_path, :method => 'get', :class => 'search-query pull-right' do       #
        = text_field_tag :query, params[:query], :class => "search-query", :placeholder => 'Search species...'    #

- content_for :js do
    = javascript_include_tag 'species'

.row
    .span3.menu-wrapper
        %ul.menu

            /******************************************************************
            /*                       SPECIES GROUP
            /******************************************************************
            %li.item
                %a.title{ :href => '#', :class => 'active' }
                    Species Groups

                %ul.subitems
                    - if @species.respond_to?('facets')
                        - @species.facets['species_group']['terms'].each do |facet|

                            - if !current_page?(params.merge(:species_group => facet['term'], :page => 1))
                                %li.subitem
                                    = link_to params.merge(:species_group => facet['term'], :page => 1) do
                                        = facet['term']
                                        %span= facet['count']

                            - else
                                %li.subitem.selected
                                    = facet['term']
                                    %span= link_to "Remove", params.except(:species_group)

            /******************************************************************
            /*                        TAXONOMY RANK
            /******************************************************************
            %li.item
                %a.title{ :href => '#', :class => 'active' }
                    Taxonomy Rank

                %ul.subitems
                    - if @species.respond_to?('facets')
                        - @species.facets['taxonomic_rank']['terms'].each do |facet|

                            - if !current_page?(params.merge(:taxonomic_rank => facet['term'], :page => 1))
                                %li.subitem
                                    = link_to params.merge(:taxonomic_rank => facet['term'], :page => 1) do
                                        = facet['term']
                                        %span= facet['count']

                            - else
                                %li.subitem.selected
                                    = facet['term']
                                    %span= link_to "Remove", params.except(:taxonomic_rank)

            /******************************************************************
            /*                           GENUS
            /******************************************************************

            / %li.item
            /     %a.title{ :href => '#', :class => 'active' }
            /         Genus

            /     %ul.subitems
            /         - if @species.respond_to?('facets')
            /             - @species.facets['genus']['terms'].each do |facet|
            /                 - if !current_page?(params.merge(:genus => facet['term'], :page => 1))
            /                     %li.subitem
            /                         = link_to params.merge(:genus => facet['term'], :page => 1) do
            /                             = facet['term']
            /                             %span= facet['count']

            /                 - else
            /                     %li.subitem.selected
            /                         = facet['term']
            /                         %span= link_to "Remove", params.except(:genus)

            /******************************************************************
            /*                           VALID NAME
            /******************************************************************

            / %li.item
            /     %a.title{ :href => '#' }
            /         Valid Name

            /     %ul.subitems
            /         - if !current_page?(params.merge(:valid => true))
            /             %li.subitem
            /                 = link_to params.merge(:valid_name => true, :page => 1) do
            /                     True
            /         - else
            /             %li.subitem.selected
            /                 True
            /                 %span= link_to "Remove", params.except(:valid_name)

            /         - if !current_page?(params.merge(:valid => false))
            /             %li.subitem
            /                 = link_to params.merge(:valid_name => false, :page => 1) do
            /                     False
            /         - else
            /             %li.subitem.selected
            /                 False
            /                 %span= link_to "Remove", params.except(:valid_name)

            /******************************************************************
            /*                           TIMELINE
            /******************************************************************
            / %li.item
            /     %a.title{ 'href' => '#', :class => 'active' }
            /         Timeline

            /     %ul.subitems
            /         - if @species.respond_to?('facets')
            /             - @species.facets['timeline']['entries'].each do |facet|
            /                 - year = Time.at(facet['time']/1000).strftime("%Y")
            /                 - if !current_page?(params.merge(:published_on => year, :page => 1))
            /                     %li.subitem
            /                         = link_to params.merge(:published_on => year, :page => 1) do
            /                             = year
            /                             %span= facet['count']

            /                 - else
            /                     %li.subitem.selected
            /                         = year.to_s
            /                         %span= link_to "Remove", params.except(:published_on)

    .span9
        - @species.results.each do |s|
            = render "cells/species", :species => s

        = page_entries_info @species
        = will_paginate @species, :renderer => BootstrapPagination::Rails
